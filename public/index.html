<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Stock Explainer AI</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://apifreellm.com/apifree.min.js"></script>
<style>
body { font-family: Arial; margin:2rem; background:#f4f4f4; }
#container { background:white; padding:2rem; border-radius:10px; max-width:800px; margin:auto; }
input, button { padding:0.5rem; font-size:1rem; }
#result { margin-top:1rem; }
canvas { margin-top:1rem; max-width:100%; }
</style>
</head>
<body>
<div id="container">
<h2>üìà Stock Explainer AI</h2>
<input id="ticker" placeholder="Enter ticker (AAPL)">
<button onclick="analyze()">Analyze</button>
<div id="result"></div>
<canvas id="chart"></canvas>
</div>

<script>
let chart;
async function analyze() {
  const ticker = document.getElementById('ticker').value.trim();
  if(!ticker) return alert('Enter a ticker!');
  document.getElementById('result').innerHTML = '‚è≥ Analyzing...';

  try {
    const res = await fetch('/api/stock/' + ticker);
    const data = await res.json();
    if(data.error){ document.getElementById('result').innerHTML = '‚ùå '+data.error; return; }

    // Example: display Finnhub price
    const price = data.finnhub.c || 'N/A';
    document.getElementById('result').innerHTML = `
      <h3>${ticker}</h3>
      <p><b>Current Price (Finnhub):</b> $${price}</p>
      <p><b>AI Explanation:</b> <span id="ai-output">‚è≥ Generating...</span></p>
    `;

    // Generate AI explanation
    const explanation = await apifree.chat(`Explain stock ${ticker} to a beginner in simple language.`)
      .then(apifree.print);
    document.getElementById('ai-output').innerText = explanation;

  } catch(err){ document.getElementById('result').innerHTML = '‚ùå '+err.message; }
}
</script>
</body>
</html>
